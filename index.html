<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Find Your Seat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      text-align: center;
      padding: 40px 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    p {
      color: #555;
    }
    input {
      padding: 14px;
      width: 100%;
      max-width: 400px;
      font-size: 18px;
      margin-top: 20px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .result {
      font-size: 22px;
      margin-top: 25px;
    }
  </style>
</head>

<body>

<h1>Find Your Seat</h1>
<p>Type your name below</p>

<input
  type="text"
  id="searchInput"
  placeholder="e.g. Maria"
  autocomplete="off"
/>

<div class="result" id="result"></div>

<!-- Tabletop.js to fetch live Google Sheets -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.6.0/tabletop.min.js"></script>
<script>
  // Use your published Google Sheet (pubhtml)
  const publicSpreadsheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSXlxYVedL786zVmjD-slSKfgwqK95YYp2J90_NF6mPzFpVd7PSyr5NMZbbG8fhwAxJf5N31jMcGAp8/pubhtml";

  Tabletop.init({
    key: publicSpreadsheetUrl,
    simpleSheet: true,
    callback: function(data) {
      // Map sheet rows to lowercase names for matching
      const rows = data.map(row => ({
        name: row.Name?.toLowerCase().trim(),
        table: row.Table?.trim()
      }));

      console.log("Loaded rows:", rows); // Debug: check data

      const input = document.getElementById("searchInput");
      const result = document.getElementById("result");

      let debounceTimeout;
      input.addEventListener("input", () => {
        clearTimeout(debounceTimeout);
        debounceTimeout = setTimeout(() => {
          const value = input.value.toLowerCase().trim();

          if (!value) {
            result.innerHTML = "";
            return;
          }

          const matches = rows.filter(r => r.name.startsWith(value));

          if (matches.length) {
            result.innerHTML = "✨ You are seated at:<br>" +
              matches.map(m => `<strong>Table ${m.table}</strong>`).join("<br>");
          } else {
            result.innerHTML = "No match yet — please check spelling";
          }
        }, 250); // Debounce 250ms
      });

      input.focus(); // Auto-focus input field
    },
    simpleSheet: true,
    debug: true // Optional: log extra info for troubleshooting
  });
</script>

</body>
</html>
